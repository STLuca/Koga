parser hosted;

structures {
    core.Structure;
    core.Int;
    core.Pointer;
    core.InterfaceReference IRef;
    core.Reference;
    core.Array;
    core.Task;
}

documents {
    collection.List;
    collection.ListAccessor;
    collection.StaticListAccessor;
}

collection.StaticList<Structure T> implements List {

    Int size;
    Array<T> items;

    init(Structure<T> struct, Int sizeIn) {
        ~ Init size
        Pointer<Int> thisSize this(size);
        Int startSize 0;
        thisSize <- startSize;

        ~ Init items
        Pointer<Array<T>> thisItems this(items);
        Array<T> newItems dynamic(struct sizeIn);
        thisItems <- newItems;

        Task t complete();
    }

    accessor(Pointer<IRef<ListAccessor<T>>> accessorOut) {
        Reference<StaticList<T>> this this();
        Reference<StaticListAccessor<T>> accessor new();
        accessor init(this);
        IRef<ListAccessor> listAccessor (accessor);
        accessorOut <- listAccessor;

        Task t complete();
    }

}